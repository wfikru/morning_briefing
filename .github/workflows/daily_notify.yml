stages:
  - briefing

morning_briefing:
  stage: briefing
  image: python:3.12-slim

  before_script:
    - pip install --no-cache-dir -r requirements.txt

  script:
    - python morning_briefing.py   # or python scripts/morning_briefing.py if in subfolder

  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule"
      when: always
    - when: never                  # ‚Üê important: blocks normal commits / MRs / etc.

  # Optional: fail fast if keys are missing
  # You can also add:
  #   - test -n "$POLYGON_API_KEY" || (echo "POLYGON_API_KEY missing" && exit 1)
  #   - test -n "$NEWSAPI_KEY"     || (echo "NEWSAPI_KEY missing"     && exit 1)